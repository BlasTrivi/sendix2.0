<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Demo Animación de Ruta — SENDIX</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    :root{
      --bg:#f6f8fa; --card:#ffffff; --ink:#0E2F44; --muted:#5A6C79; --road:#d0e6f7; --road2:#8bb7d6;
    }
    body{font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial; margin:0; background:var(--bg); color:var(--ink)}
    .wrap{max-width:960px; margin:24px auto; padding:16px}
    .card{background:var(--card); border-radius:16px; box-shadow:0 10px 30px rgba(14,47,68,.08); padding:18px}
    h1{font-size:22px; margin:0 0 12px}
    .muted{color:var(--muted)}
    .panel{display:flex; gap:12px; align-items:center; margin:8px 0 16px}
    .panel input{padding:10px 12px; border-radius:10px; border:1px solid #e3edf2; flex:1; font-size:15px}
    .panel button{padding:10px 14px; border:none; background:#0ea5a5; color:#fff; border-radius:10px; cursor:pointer}
    #stage{width:100%; height:340px; border-radius:16px; overflow:hidden; position:relative; background: linear-gradient(130deg,#eaf1f6 60%,#cfe5e8);}
    #svg{width:100%; height:100%}
    .badge{display:inline-block; padding:4px 8px; border-radius:999px; background:#eef7f7; color:#0ea5a5; font-weight:700; font-size:12px}
  </style>
  </head>
  <body>
    <div class="wrap">
      <div class="card">
        <h1>Demo animada de envío <span class="badge">simulada</span></h1>
        <div class="muted">Animación tipo mapa con camión moviéndose de Origen a Destino.</div>
        <div class="panel">
          <input id="origen" placeholder="Origen (solo texto)" value="Buenos Aires" />
          <input id="destino" placeholder="Destino (solo texto)" value="Rosario" />
          <button id="reiniciar">Reiniciar</button>
        </div>
        <div id="stage">
          <svg id="svg" viewBox="0 0 800 340" preserveAspectRatio="xMidYMid slice">
            <!-- Fondo con "calles" -->
            <g opacity=".25" stroke="#adc9d6" stroke-width="2">
              <path d="M20 40 H780 M20 140 H780 M20 240 H780"/>
              <path d="M100 20 V320 M300 20 V320 M500 20 V320 M700 20 V320"/>
            </g>
            <!-- Carretera principal curvada -->
            <path id="route" d="M60,280 C200,220 280,120 400,140 C540,170 620,80 740,100" fill="none" stroke="var(--road)" stroke-width="18" stroke-linecap="round"/>
            <path id="routeEdge" d="M60,280 C200,220 280,120 400,140 C540,170 620,80 740,100" fill="none" stroke="var(--road2)" stroke-width="4" stroke-dasharray="10 8"/>
            <!-- Puntos Origen/Destino -->
            <circle cx="60" cy="280" r="10" fill="#fff" stroke="var(--ink)" stroke-width="3"/>
            <circle cx="740" cy="100" r="10" fill="#fff" stroke="var(--ink)" stroke-width="3"/>
            <!-- Labels -->
            <text id="lblOrigen" x="60" y="310" text-anchor="middle" font-size="14" fill="var(--muted)">Buenos Aires</text>
            <text id="lblDestino" x="740" y="80" text-anchor="middle" font-size="14" fill="var(--muted)">Rosario</text>
            <!-- Camión (vector simple) -->
            <g id="truck" transform="translate(60,280)">
              <rect x="-20" y="-14" width="40" height="18" fill="#0E2F44" rx="3"/>
              <rect x="-6" y="-22" width="22" height="12" fill="#0E2F44" rx="2"/>
              <circle cx="-10" cy="6" r="5" fill="#162c3b"/>
              <circle cx="12" cy="6" r="5" fill="#162c3b"/>
              <rect x="-2" y="-20" width="10" height="6" fill="#7fd3cd" rx="1"/>
            </g>
          </svg>
        </div>
      </div>
    </div>
    <script>
      const svg = document.getElementById('svg');
      const path = document.getElementById('route');
      const truck = document.getElementById('truck');
      const lblO = document.getElementById('lblOrigen');
      const lblD = document.getElementById('lblDestino');
      const inputO = document.getElementById('origen');
      const inputD = document.getElementById('destino');
      const btnR = document.getElementById('reiniciar');

      function setTruckAt(t){
        const L = path.getTotalLength();
        const p = path.getPointAtLength(L * t);
        const delta = 0.01; // para ángulo
        const p2 = path.getPointAtLength(Math.min(L, L * t + L*delta));
        const angle = Math.atan2(p2.y - p.y, p2.x - p.x) * 180/Math.PI;
        truck.setAttribute('transform', `translate(${p.x},${p.y}) rotate(${angle})`);
      }

      let t = 0; let dir = 1; // 0 -> 1 ida y vuelta
      function loop(){
        t += dir * 0.0035; // velocidad
        if(t >= 1){ t = 1; dir = -1; }
        if(t <= 0){ t = 0; dir = 1; }
        setTruckAt(t);
        requestAnimationFrame(loop);
      }
      setTruckAt(0);
      requestAnimationFrame(loop);

      function updateLabels(){
        lblO.textContent = inputO.value || 'Origen';
        lblD.textContent = inputD.value || 'Destino';
      }
      inputO.addEventListener('input', updateLabels);
      inputD.addEventListener('input', updateLabels);
      btnR.addEventListener('click', ()=>{ t = 0; dir = 1; setTruckAt(0); });
      updateLabels();
    </script>
  </body>
</html>
